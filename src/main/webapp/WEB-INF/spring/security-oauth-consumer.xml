<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://spring-security-oauth.codehaus.org/3.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://spring-security-oauth.codehaus.org/3.0 http://spring-security-oauth.codehaus.org/schema/spring-security-oauth-3.0.xsd">

	<consumer resource-details-service-ref="resourceDetails" token-services-factory-ref="consumerTokenServicesFactory">
		<url pattern="/settings/twitter/authorize**" resources="Twitter" />
	</consumer>

	<resource-details-service id="resourceDetails">
		<resource id="Twitter" key="QLM4vX68dBRLG1sE7zSJiA"
			secret="4Ah41ojlwi249GCI1UU5oKolmNDpjLLXgPKwGfVs0"
			request-token-url="https://twitter.com/oauth/request_token"
			user-authorization-url="https://twitter.com/oauth/authorize"
			access-token-url="https://twitter.com/oauth/access_token" />
	</resource-details-service>

	<beans:bean id="consumerTokenServicesFactory"  class="com.springsource.greenhouse.oauth.JdbcOAuthConsumerTokenServicesFactory">
		<beans:constructor-arg ref="jdbcTemplate" />
	</beans:bean>
	
	<!-- Twitter Client API -->
	<beans:bean id="twitterService" class="org.springframework.social.twitter.TwitterTemplate">
		<beans:constructor-arg>
			<beans:bean class="org.springframework.social.oauth.OAuthSpringSecurityOAuthTemplate">
				<beans:constructor-arg value="Twitter" />
				<!-- TODO: I don't like how I have to know the name of the consumer support bean. Considering
				having this implementation of OAuthTemplate be ApplicationContextAware and have it seek out the
				consumer support bean. -->
				<beans:constructor-arg ref="oauthConsumerSupport" />
				<beans:constructor-arg ref="resourceDetails" />
				<beans:constructor-arg ref="ts" />
			</beans:bean>
		</beans:constructor-arg>
	</beans:bean>

	<!-- TODO: RECONCILE THIS TOKEN SERVICES WITH THE OFFICIAL ONE -->
	<beans:bean id="ts" class="org.springframework.social.oauth.JdbcOAuthConsumerTokenServices" autowire="constructor" />	

	<!-- Facebook Client API -->
	<beans:bean id="facebook" class="org.springframework.social.facebook.FacebookTemplate" />
	
</beans:beans>